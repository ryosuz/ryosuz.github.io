---
import { experiences, education } from "@/data/experiences";
import SectionHeader from "../SectionHeader.astro";
---

<section id="experience" class="py-24 scroll-mt-24 md:scroll-mt-15">
  <div class="max-w-5xl mx-auto px-6">
    <SectionHeader title="Experience" description="エンジニアとしての経験と実績をご紹介します" />

    <div class="grid md:grid-cols-2 gap-12">
      <!-- 職歴 -->
      <div>
        <h3 class="text-sm font-medium text-ink-muted uppercase tracking-wider mb-6 slide-in-left">
          Work Experience
        </h3>
        <div class="space-y-8">
          {experiences.map((exp, index) => (
            <div
              class="border-l-2 border-ink/20 pl-6 relative slide-in-left"
              style={`--delay: ${index * 0.15}s`}
            >
              <div class:list={[
                "absolute w-3 h-3 rounded-full -left-[7px] top-1",
                index === 0 ? "bg-ink" : "bg-ink/40"
              ]}></div>
              <p class="text-sm text-ink-muted mb-1">{exp.period}</p>
              <p class="text-ink font-medium">{exp.title}</p>
              <p class="text-ink-light text-sm">{exp.company} / {exp.location}</p>
              <ul class="text-ink-light text-sm mt-2 space-y-1">
                {exp.description.map((desc) => (
                  <li class="flex items-start gap-2">
                    <span class="text-ink/40 mt-1">•</span>
                    <span>{desc}</span>
                  </li>
                ))}
              </ul>
              <div class="flex flex-wrap gap-2 mt-3">
                {exp.technologies.map((tech) => (
                  <span class="text-xs px-2 py-1 bg-ink/5 text-ink-muted rounded">
                    {tech}
                  </span>
                ))}
              </div>
            </div>
          ))}
        </div>
      </div>

      <!-- 学歴 -->
      <div>
        <h3 class="text-sm font-medium text-ink-muted uppercase tracking-wider mb-6 slide-in-right">
          Education
        </h3>
        <div class="space-y-8">
          {education.map((edu, index) => (
            <div
              class="border-l-2 border-ink/20 pl-6 relative slide-in-right"
              style={`--delay: ${index * 0.15}s`}
            >
              <div class:list={[
                "absolute w-3 h-3 rounded-full -left-[7px] top-1",
                index === 0 ? "bg-ink" : "bg-ink/40"
              ]}></div>
              <p class="text-sm text-ink-muted mb-1">{edu.period}</p>
              <p class="text-ink font-medium">{edu.school}</p>
              <p class="text-ink-light text-sm">{edu.degree}</p>
              <p class="text-ink-light text-sm mt-1">{edu.description}</p>
            </div>
          ))}
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .slide-in-left,
  .slide-in-right {
    opacity: 0;
    transition: opacity 0.6s ease-out, transform 0.6s ease-out;
    transition-delay: var(--delay, 0s);
  }

  .slide-in-left {
    transform: translateX(-40px);
  }

  .slide-in-right {
    transform: translateX(40px);
  }

  .slide-in-left.visible,
  .slide-in-right.visible {
    opacity: 1;
    transform: translateX(0);
  }
</style>

<script>
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    },
    { threshold: 0.1, rootMargin: '0px 0px -50px 0px' }
  );

  document.querySelectorAll('.slide-in-left, .slide-in-right').forEach((el) => {
    observer.observe(el);
  });
</script>
